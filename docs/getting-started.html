<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Getting Started</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Jason</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1  current"><a href="getting-started.html"><div class="inner"><span>Getting Started</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jason</span></div></div></li><li class="depth-2 branch"><a href="jason.convenience.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>convenience</span></div></a></li><li class="depth-2"><a href="jason.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#getting-started" id="getting-started"></a>Getting Started</h1>
<p><code>jason</code> is a thin wrapper around <a href="https://metosin.github.io/jsonista"><code>jsonista</code></a>, a <a href="https://github.com/FasterXML/jackson"><code>jackson</code></a> based JSON encoding and decoding library, providing sensible default but fully configurable key conversion facilities.</p>
<p><code>jackson</code> utilises an <code>ObjectMapper</code> instance for all JSON serialisation and deserialisation. <code>ObjectMapper</code> instances are expensive to create and should be reused as much as possible. As such, <code>jason</code> aims to minimise the number of <code>ObjectMapper</code> instances required.</p>
<h2><a href="#building-coder-functions" id="building-coder-functions"></a>Building coder functions</h2>
<p>To build an encoder and decoder:</p>
<pre><code class="language-clojure">(require '[jason.core :as jason])

(def default-object-mapper (jason/new-object-mapper))
(def -&gt;default-json (jason/new-json-encoder default-object-mapper))
(def &lt;-default-json (jason/new-json-decoder default-object-mapper))

(-&gt;default-json {:first-name "Jane"})
;; =&gt; "{\"first-name\":\"Jane\"}"

(&lt;-default-json "{\"firstName\":\"Jane\"}")
;; =&gt; {"firstName" "Jane"}
</code></pre>
<p>As shown, by default, the encoder will leave keys untouched during encoding and decoding.</p>
<h3><a href="#basic-configuration" id="basic-configuration"></a>Basic configuration</h3>
<p>To change the conversions:</p>
<pre><code class="language-clojure">(require '[camel-snake-kebab.core 
           :refer [-&gt;snake_case_string
                   -&gt;snake_case_keyword]])

(def custom-object-mapper (jason/new-object-mapper
                            {:encode-key-fn 
                             (jason/-&gt;encode-key-fn -&gt;snake_case_string)
                             :decode-key-fn
                             (jason/-&gt;decode-key-fn -&gt;snake_case_keyword)}))
(def -&gt;custom-json (jason/new-json-encoder custom-object-mapper))
(def &lt;-custom-json (jason/new-json-decoder custom-object-mapper))

(-&gt;custom-json {:first-name "Jane"})
;; =&gt; "{\"first_name\":\"Jane\"}"

(&lt;-custom-json "{\"firstName\":\"Jane\"}")
;; =&gt; {:first_name "Jane"}
</code></pre>
<h3><a href="#meta-handling" id="meta-handling"></a>Meta handling</h3>
<p>In addition to key conversion for standard keys, <code>jason</code> is aware of metadata keys. By default these are keys prefixed with an underscore, e.g., <code>_links</code>. By default metadata keys are left untouched and the conversion functions returned by <code>-&gt;encode-key-fn</code> and <code>-&gt;decode-key-fn</code> convert the key whilst retaining the metadata prefix:</p>
<pre><code class="language-clojure">(def default-encode-key-fn (jason/-&gt;encode-key-fn))
(def default-decode-key-fn (jason/-&gt;decode-key-fn))

(default-encode-key-fn :_meta-data)
;; =&gt; "_metaData"

(default-decode-key-fn "_metaData")
;; =&gt; :_meta-data

(def custom-encode-key-fn (jason/-&gt;encode-key-fn -&gt;snake_case_string))
(def custom-decode-key-fn (jason/-&gt;decode-key-fn -&gt;snake_case_keyword))

(custom-encode-key-fn :_meta-data)
;; =&gt; "_meta_data"

(custom-decode-key-fn "_metaData")
;; =&gt; :_meta_data
</code></pre>
<p>To fully override the metadata handling:</p>
<pre><code class="language-clojure">(def heterogeneous-encode-key-fn (jason/-&gt;encode-key-fn 
                                   {:standard-key-fn -&gt;snake_case_string
                                    :meta-key-fn name}))
(def heterogeneous-decode-key-fn (jason/-&gt;decode-key-fn
                                   {:standard-key-fn -&gt;snake_case_keyword
                                    :meta-key-fn keyword}))

(heterogeneous-encode-key-fn :_meta-data)
;; =&gt; "_meta-data"
(heterogeneous-encode-key-fn :other-field)
;; =&gt; "other_field"

(heterogeneous-decode-key-fn "_metaData")
;; =&gt; :_metaData
(heterogeneous-decode-key-fn "otherField")
;; =&gt; :other_field
</code></pre>
<h3><a href="#additional-configuration" id="additional-configuration"></a>Additional configuration</h3>
<p>In addition to key function configuration, <a href="jason.core.html#var-new-object-mapper">jason.core/new-object-mapper</a> exposes all configuration options of the underlying <code>jsonista</code> library.</p>
<p>See <a href="jason.core.html#var-new-object-mapper">jason.core/new-object-mapper</a> for more details.</p>
<h2><a href="#defining-coder-functions-using-new-json-coders-and-defcoders" id="defining-coder-functions-using-new-json-coders-and-defcoders"></a>Defining coder functions using <code>new-json-coders</code> and <code>defcoders</code></h2>
<p>The <a href="jason.core.html#var-new-json-coders">jason.core/new-json-coders</a> function builds both coders at once and returns them in a map, hiding the details of the <code>ObjectMapper</code>:</p>
<pre><code class="language-clojure">(let [{:keys [-&gt;json &lt;-json]} 
      (jason/new-json-coders
        :encode-key-fn (jason/-&gt;encode-key-fn)
        :decode-key-fn (jason/-&gt;decode-key-fn))]
  (-&gt;json {:first-name "Jess"})
  ;; =&gt; "{\"firstName\":\"Jess\"}"

  (&lt;-json "{\"lastName\":\"Jacobs\"}")
  ;; =&gt; {:last-name "Jacobs"}
  )

(let [{:keys [-&gt;json &lt;-json]} 
      (jason/new-json-coders
        {:encode-key-fn (jason/-&gt;encode-key-fn -&gt;snake_case_string)
         :decode-key-fn (jason/-&gt;decode-key-fn -&gt;snake_case_keyword)})]
  (-&gt;json {:first-name "Jane"})
  ;; =&gt; "{\"first_name\":\"Jane\"}"
  
  (&lt;-json "{\"firstName\":\"Jane\"}")
  ;; =&gt; {:first_name "Jane"}
  )
</code></pre>
<p>Usually, youâ€™ll want to hang on to the resulting coders for later use. This can be achieved with:</p>
<pre><code class="language-clojure">(let [{:keys [-&gt;json &lt;-json]} 
      (jason/new-json-coders
        {:encode-key-fn (jason/-&gt;encode-key-fn -&gt;snake_case_string)
         :decode-key-fn (jason/-&gt;decode-key-fn -&gt;snake_case_keyword)})]
  (def -&gt;db-json -&gt;json)
  (def &lt;-db-json &lt;-json))
</code></pre>
<p>However, for convenience, the <code>defcoders</code> macro performs this task for you:</p>
<pre><code class="language-clojure">(require '[jason.core :refer [defcoders]])

(defcoders db
  :encode-key-fn (jason/-&gt;encode-key-fn -&gt;snake_case_string)
  :decode-key-fn (jason/-&gt;decode-key-fn -&gt;snake_case_keyword))

(-&gt;db-json {:first-name "Jane"})
;; =&gt; "{\"first_name\":\"Jane\"}"
  
(&lt;-db-json "{\"firstName\":\"Jane\"}")
;; =&gt; {:first_name "Jane"}
</code></pre>
<p>All options that can be passed to <code>new-json-coders</code> or <code>new-object-mapper</code> also apply to <code>defcoders</code>.</p>
<h2><a href="#convenience-coder-functions" id="convenience-coder-functions"></a>Convenience coder functions</h2>
<p><code>jason</code> includes convenience coder functions for wire JSON (e.g., from service to service) and database JSON (e.g., for databases that support JSON types).</p>
<p>The wire JSON coders: - convert from kebab-case keywords to camelCase JSON and back again</p>
<p>To use the wire JSON coders:</p>
<pre><code class="language-clojure">(require '[jason.convenience :as conv])

(conv/-&gt;wire-json {:first-name "Jane"})
;; =&gt; "{\n  \"firstName\" : \"Jane\"\n}"
  
(conv/&lt;-wire-json "{\n  \"firstName\" : \"Jane\"\n}")
;; =&gt; {:first-name "Jane"}
</code></pre>
<p>The database JSON coders: - convert from kebab-case keywords to snake_case JSON and back again</p>
<p>To use the database JSON coders:</p>
<pre><code class="language-clojure">(require '[jason.convenience :as conv])

(conv/-&gt;db-json {:first-name "Jane"})
;; =&gt; "{\n  \"first_name\" : \"Jane\"\n}"
  
(conv/&lt;-db-json "{\n  \"first_name\" : \"Jane\"\n}")
;; =&gt; {:first-name "Jane"}
</code></pre>
</div></div></div></body></html>